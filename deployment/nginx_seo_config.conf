# Configuración SEO para Nginx
# Incluir este archivo en tu configuración principal de Nginx

# Configuración de compresión GZIP
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_proxied any;
gzip_comp_level 6;
gzip_types
    text/plain
    text/css
    text/xml
    text/javascript
    application/json
    application/javascript
    application/xml+rss
    application/atom+xml
    image/svg+xml;

# Configuración de cache para archivos estáticos
location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
    add_header X-Content-Type-Options nosniff;
}

# Configuración específica para robots.txt y sitemap
location = /robots.txt {
    expires 1d;
    add_header Cache-Control "public";
}

location = /sitemap.xml {
    expires 1d;
    add_header Cache-Control "public";
    add_header Content-Type "application/xml; charset=utf-8";
}

location = /sitemap-index.xml {
    expires 1d;
    add_header Cache-Control "public";
    add_header Content-Type "application/xml; charset=utf-8";
}

# Headers de seguridad
add_header X-Frame-Options "DENY" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Configuración de rate limiting (opcional)
# limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
# location /api/ {
#     limit_req zone=api burst=20 nodelay;
# }

# Redirección de www a no-www (descomenta si prefieres no-www)
# server {
#     listen 80;
#     server_name www.tudominio.com;
#     return 301 $scheme://tudominio.com$request_uri;
# }

# Configuración de seguridad adicional
location ~ /\. {
    deny all;
}

location ~ /(config|instance|logs|migrations|venv|deployment)/ {
    deny all;
}

# Configuración para archivos de favicon
location = /favicon.ico {
    expires 1y;
    add_header Cache-Control "public";
}

location = /favicon.svg {
    expires 1y;
    add_header Cache-Control "public";
}
